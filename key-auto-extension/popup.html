<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    body {
      width: 350px;
      padding: 20px;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      margin: 0;
    }
    
    h1 {
      font-size: 20px;
      margin: 0 0 15px 0;
      text-align: center;
      text-shadow: 0 1px 3px rgba(0,0,0,0.3);
    }
    
    .container {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 20px;
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    button {
      width: 100%;
      padding: 12px;
      background: rgba(255,255,255,0.2);
      color: white;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 8px;
      cursor: pointer;
      margin: 8px 0;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    button:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    .primary-btn {
      background: rgba(76, 175, 80, 0.8);
      border-color: rgba(76, 175, 80, 0.9);
    }
    
    .primary-btn:hover {
      background: rgba(76, 175, 80, 0.9);
    }
    
    .secondary-btn {
      background: rgba(33, 150, 243, 0.8);
      border-color: rgba(33, 150, 243, 0.9);
    }
    
    .secondary-btn:hover {
      background: rgba(33, 150, 243, 0.9);
    }
    
    .test-btn {
      background: rgba(255, 193, 7, 0.8);
      border-color: rgba(255, 193, 7, 0.9);
    }
    
    .test-btn:hover {
      background: rgba(255, 193, 7, 0.9);
    }
    
    #status {
      margin: 15px 0 10px 0;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      font-size: 13px;
      font-weight: 500;
      min-height: 20px;
      backdrop-filter: blur(10px);
    }
    
    .success {
      background: rgba(76, 175, 80, 0.8);
      border: 1px solid rgba(76, 175, 80, 0.9);
    }
    
    .error {
      background: rgba(244, 67, 54, 0.8);
      border: 1px solid rgba(244, 67, 54, 0.9);
    }
    
    .info {
      background: rgba(33, 150, 243, 0.8);
      border: 1px solid rgba(33, 150, 243, 0.9);
    }
    
    .auto-status {
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      padding: 10px;
      margin: 10px 0;
      font-size: 12px;
    }
    
    .divider {
      height: 1px;
      background: rgba(255,255,255,0.2);
      margin: 15px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîë Key Auto Collector</h1>
    
    <div class="auto-status">
      <div>ü§ñ T·ª± ƒë·ªông: Ch·∫°y m·ªói 20 ph√∫t</div>
      <div>üì± Token s·∫Ω g·ª≠i qua Telegram bot</div>
      <div>üîó Bot: @tokencussor_bot</div>
    </div>
    
    <button id="testTelegramBtn" class="test-btn">üì± Test Telegram</button>
    <button id="autoCollectBtn" class="primary-btn">üöÄ T·ª± ƒê·ªông L·∫•y Token Ngay</button>
    
    <div class="divider"></div>
    
    <button id="clickGetTokenBtn" class="secondary-btn">üëÜ Click N√∫t "L·∫•y Token"</button>
    <button id="extractTokenBtn" class="secondary-btn">üîç T√¨m Token Tr√™n Trang</button>
    <button id="manualSendBtn" class="secondary-btn">üì§ G·ª≠i Token Th·ªß C√¥ng</button>
    
    <div id="status"></div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const testTelegramBtn = document.getElementById('testTelegramBtn');
      const autoCollectBtn = document.getElementById('autoCollectBtn');
      const clickGetTokenBtn = document.getElementById('clickGetTokenBtn');
      const extractTokenBtn = document.getElementById('extractTokenBtn');
      const manualSendBtn = document.getElementById('manualSendBtn');
      const statusDiv = document.getElementById('status');
      
      // Test Telegram
      testTelegramBtn.addEventListener('click', function() {
        showStatus("üì± ƒêang test g·ª≠i Telegram...", "info");
        chrome.runtime.sendMessage({action: "testTelegram"}, function(response) {
          if (response && response.status === "success") {
            showStatus("‚úÖ Test Telegram th√†nh c√¥ng! Ki·ªÉm tra bot @tokencussor_bot", "success");
          } else {
            showStatus("‚ùå L·ªói test Telegram: " + (response ? response.error : "Kh√¥ng x√°c ƒë·ªãnh"), "error");
          }
        });
      });
      
      // T·ª± ƒë·ªông l·∫•y token ngay
      autoCollectBtn.addEventListener('click', function() {
        showStatus("üîÑ ƒêang t·ª± ƒë·ªông l·∫•y token...", "info");
        chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
          if (chrome.runtime.lastError) {
            showStatus("‚ùå Kh√¥ng th·ªÉ k·∫øt n·ªëi v·ªõi trang!", "error");
            return;
          }
          
          chrome.tabs.sendMessage(tabs[0].id, {action: "fullAutoProcess", key: "kabistarvnzxczxc"}, function(response) {
            if (chrome.runtime.lastError) {
              showStatus("‚ùå Kh√¥ng th·ªÉ k·∫øt n·ªëi v·ªõi trang!", "error");
              return;
            }
            
            if (response && response.success) {
              showStatus("üéâ " + response.message, "success");
            } else {
              showStatus("‚ùå " + (response ? response.message : "L·ªói kh√¥ng x√°c ƒë·ªãnh"), "error");
            }
          });
        });
      });
      
      // G·ª≠i token th·ªß c√¥ng
      manualSendBtn.addEventListener('click', function() {
        const token = prompt("Nh·∫≠p token c·∫ßn g·ª≠i qua Telegram:");
        if (token && token.trim()) {
          showStatus("üì§ ƒêang g·ª≠i token qua Telegram...", "info");
          chrome.runtime.sendMessage({action: "sendToken", token: token.trim()}, function(response) {
            if (response && response.status === "success") {
              showStatus("‚úÖ ƒê√£ g·ª≠i token qua Telegram!", "success");
            } else {
              showStatus("‚ùå L·ªói g·ª≠i token: " + (response ? response.error : "Kh√¥ng x√°c ƒë·ªãnh"), "error");
            }
          });
        }
      });
      
      // Click n√∫t "L·∫•y Token"
      clickGetTokenBtn.addEventListener('click', function() {
        showStatus("üëÜ ƒêang click n√∫t...", "info");
        chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
          chrome.tabs.sendMessage(tabs[0].id, {action: "clickGetToken"}, function(response) {
            if (chrome.runtime.lastError) {
              showStatus("‚ùå Kh√¥ng th·ªÉ k·∫øt n·ªëi v·ªõi trang!", "error");
              return;
            }
            
            if (response && response.success) {
              showStatus("‚úÖ ƒê√£ click th√†nh c√¥ng!", "success");
              
              // T·ª± ƒë·ªông l·∫•y token sau khi click
              setTimeout(() => {
                chrome.tabs.sendMessage(tabs[0].id, {action: "getTokenAfterClick"}, function(tokenResponse) {
                  if (tokenResponse && tokenResponse.token) {
                    chrome.runtime.sendMessage({action: "saveToken", token: tokenResponse.token}, function(saveResponse) {
                      if (saveResponse && saveResponse.status === "success") {
                        showStatus("üéâ ƒê√£ l·∫•y v√† l∆∞u token th√†nh c√¥ng!", "success");
                      } else {
                        showStatus("‚ùå L·ªói l∆∞u token!", "error");
                      }
                    });
                  } else {
                    showStatus("‚ö†Ô∏è Click th√†nh c√¥ng nh∆∞ng kh√¥ng t√¨m th·∫•y token!", "error");
                  }
                });
              }, 3000);
            } else {
              showStatus("‚ùå Kh√¥ng th·ªÉ click n√∫t!", "error");
            }
          });
        });
      });
      
      // T√¨m token tr√™n trang
      extractTokenBtn.addEventListener('click', function() {
        showStatus("üîç ƒêang t√¨m token...", "info");
        chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
          chrome.tabs.sendMessage(tabs[0].id, {action: "extractToken"}, function(response) {
            if (chrome.runtime.lastError) {
              showStatus("‚ùå Kh√¥ng th·ªÉ k·∫øt n·ªëi v·ªõi trang!", "error");
              return;
            }
            
            if (response && response.token) {
              chrome.runtime.sendMessage({action: "sendToken", token: response.token}, function(sendResponse) {
                if (sendResponse && sendResponse.status === "success") {
                  showStatus("üéâ T√¨m th·∫•y v√† g·ª≠i token qua Telegram!", "success");
                } else {
                  showStatus("‚ùå L·ªói g·ª≠i token!", "error");
                }
              });
            } else {
              showStatus("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y token tr√™n trang!", "error");
            }
          });
        });
      });
      
      // H√†m hi·ªÉn th·ªã tr·∫°ng th√°i
      function showStatus(message, type) {
        statusDiv.textContent = message;
        statusDiv.className = type;
        
        // T·ª± ƒë·ªông ·∫©n sau 5 gi√¢y
        setTimeout(() => {
          statusDiv.textContent = '';
          statusDiv.className = '';
        }, 5000);
      }
      
      // Hi·ªÉn th·ªã tr·∫°ng th√°i ban ƒë·∫ßu
      showStatus("‚ú® Extension ƒë√£ s·∫µn s√†ng!", "info");
    });
  </script>
</body>
</html>